import streamlit as st
import datetime

st.set_page_config(page_title="äºˆç´„æ–‡ç« ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼", layout="wide")

# æ—¥æœ¬èªæ›œæ—¥
def jp_weekday(date):
    return ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"][date.weekday()]


# ===== ã‚µã‚¤ãƒ‰ãƒãƒ¼å…¥åŠ› =====
st.sidebar.title("äºˆç´„æƒ…å ±å…¥åŠ›")

reserve_date = st.sidebar.date_input("æ—¥ä»˜ã‚’é¸æŠ")
reserve_time = st.sidebar.time_input("é–‹å§‹æ™‚é–“")
course = st.sidebar.selectbox(
    "ã‚³ãƒ¼ã‚¹ã‚’é¸æŠ",
    ["60åˆ†","90åˆ†","120åˆ†","150åˆ†","180åˆ†","210åˆ†","240åˆ†"]
)

place = st.sidebar.selectbox(
    "å ´æ‰€ã‚’é¸æŠ",
    [
        "æ–°å®¿(æ­Œèˆä¼ç”º)",
        "æ¸‹è°·(é“ç„å‚)",
        "é¶¯è°·",
        "æ± è¢‹",
        "äº”åç”°",
        "éŒ¦ç³¸ç”º",
        "ã‚¢ãƒ«ãƒ•ã‚¡ã‚¤ãƒ³"
    ]
)

option = st.sidebar.selectbox("ã‚ªãƒ—ã‚·ãƒ§ãƒ³", ["ãªã—","ä¹³é¦–èˆã‚"])
special_fee = st.sidebar.number_input("ãã®ä»–ï¼ˆç‰¹åˆ¥æ–™é‡‘ï¼‰", 0, 50000, 0)

# ===== æ–™é‡‘è¨­å®š =====
course_price = {
    "60åˆ†":20000,
    "90åˆ†":25000,
    "120åˆ†":35000,   # â† ã“ã“å¤‰æ›´æ¸ˆã¿
    "150åˆ†":45000,
    "180åˆ†":55000,
    "210åˆ†":65000,
    "240åˆ†":75000
}

travel_fee = {
    "æ–°å®¿(æ­Œèˆä¼ç”º)":0,
    "æ¸‹è°·(é“ç„å‚)":0,
    "é¶¯è°·":0,
    "æ± è¢‹":1000,
    "äº”åç”°":1000,
    "éŒ¦ç³¸ç”º":1000,
    "ã‚¢ãƒ«ãƒ•ã‚¡ã‚¤ãƒ³":3000
}

option_fee = 2000 if option == "ä¹³é¦–èˆã‚" else 0

total_price = course_price[course] + travel_fee[place] + option_fee + special_fee


# ===== ã“ã“ã‹ã‚‰å‡ºåŠ›ã‚¨ãƒªã‚¢ =====
st.title("äºˆç´„æ–‡ç« ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼")
st.write("ï¼ˆåŸºæœ¬æƒ…å ±ã®å‡ºåŠ›ã¯ç„¡ã—ã«å¤‰æ›´æ¸ˆã¿ï¼‰")


# -------------------------------------------------------------------
# æ–°è¦ DMâ‘ 
# -------------------------------------------------------------------
weekday = jp_weekday(reserve_date)

dm_1 = f"""
ã”é€£çµ¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™â˜ºï¸  

ã€ã”äºˆç´„å†…å®¹ã€‘  
{reserve_date.month}æœˆ{reserve_date.day}æ—¥ï¼ˆ{weekday}ï¼‰ {reserve_time.strftime("%H:%M")}ã€œ  
{course}  
å ´æ‰€ï¼š{place}  

ã‚ˆã‚ã—ã‘ã‚Œã°ã€ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒ•ã‚©ãƒ¼ãƒ ã®ã”å…¥åŠ›ã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚  
"""

# -------------------------------------------------------------------
# æ–°è¦ DMâ‘¡
# -------------------------------------------------------------------
dm_2 = f"""
ã”å…¥åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™â˜ºï¸  

ãã‚Œã§ã¯ã€ã”äºˆç´„ç¢ºå®šã¨ãªã‚Šã¾ã™âœ¨  
å½“æ—¥ã¯ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚  

ã€ã”äºˆç´„å†…å®¹ã€‘  
{reserve_date.month}æœˆ{reserve_date.day}æ—¥ï¼ˆ{weekday}ï¼‰ {reserve_time.strftime("%H:%M")}ã€œ  
{course}  
å ´æ‰€ï¼š{place}  

åˆè¨ˆé‡‘é¡ï¼šÂ¥{total_price:,}  
"""

# -------------------------------------------------------------------
# å½“æ—¥äºˆç´„ï¼šãƒ¡ãƒ¼ãƒ«â‘ 
# -------------------------------------------------------------------
mail_1 = f"""
{reserve_date.month}æœˆ{reserve_date.day}æ—¥ï¼ˆ{weekday}ï¼‰ {reserve_time.strftime("%H:%M")}ã€œã®ã”äºˆç´„ã«ã¤ã„ã¦æ‰¿ã‚Šã¾ã—ãŸã€‚  

ã¾ãšã¯ã‚«ã‚¦ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒ•ã‚©ãƒ¼ãƒ ã¸ã®ã”å…¥åŠ›ã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚  
"""

# -------------------------------------------------------------------
# å½“æ—¥äºˆç´„ï¼šãƒ¡ãƒ¼ãƒ«â‘¡ï¼ˆâ€»ä»¶åè¿½åŠ æ¸ˆã¿ï¼‰
# -------------------------------------------------------------------
mail_2 = f"""
ä»¶åï¼šæœ¬æ—¥ã®ã”äºˆç´„ç¢ºå®šã®ã”æ¡ˆå†…/ã‚€ãèŒ¶

{reserve_date.month}æœˆ{reserve_date.day}æ—¥ï¼ˆ{weekday}ï¼‰ {reserve_time.strftime("%H:%M")}ã€œã®å½“æ—¥äºˆç´„ã«ã¤ã„ã¦æ‰¿ã‚Šã¾ã—ãŸã€‚  

ã”å…¥åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚  
ã”äºˆç´„ãŒç¢ºå®šã„ãŸã—ã¾ã—ãŸã®ã§ã€å½“æ—¥ã¯ãŠæ°—ã‚’ã¤ã‘ã¦ãŠè¶Šã—ãã ã•ã„ã¾ã›ã€‚  

ã€ã”äºˆç´„å†…å®¹ã€‘  
{course}  
å ´æ‰€ï¼š{place}  

åˆè¨ˆé‡‘é¡ï¼šÂ¥{total_price:,}  
"""


# ===== è¡¨ç¤ºéƒ¨åˆ† =====
col1, col2 = st.columns(2)

with col1:
    st.subheader("ğŸ“© æ–°è¦ DMâ‘ ")
    st.code(dm_1)

    st.subheader("ğŸ“© æ–°è¦ DMâ‘¡")
    st.code(dm_2)

with col2:
    st.subheader("ğŸ“§ å½“æ—¥äºˆç´„ ãƒ¡ãƒ¼ãƒ«â‘ ")
    st.code(mail_1)

    st.subheader("ğŸ“§ å½“æ—¥äºˆç´„ ãƒ¡ãƒ¼ãƒ«â‘¡ï¼ˆä»¶åå…¥ã‚Šï¼‰")
    st.code(mail_2)

